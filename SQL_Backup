-----Create Purchases Schema-----

CREATE SCHEMA purchases

-----Crate tables for purchases-----

---Create items Table---

CREATE TABLE purchases.items
(
    Order_Date varchar (256),
    Order_ID text,
    Title text,
    Category text,
    ASIN_ISBN text,
    UNSPSC_Code text,
    Website text,
    Release_Date varchar (256),
    Condition text,
    Seller text,
    Seller_Credentials text,
    List_Price_Per_Unit money,
    Purchase_Price_Per_Unit money,
    Quantity int,
    Payment_Instrument_Type text,
    Purchase_Order_Number text,
    PO_Line_Number text,
    Ordering_Customer_Email text,
    Shipment_Date varchar (256),
    Shipping_Address_Name text,
    Shipping_Address_Street_1 text,
    Shipping_Address_Street_2 text,
    Shipping_Address_City text,
    Shipping_Address_State text,
    Shipping_Address_Zip text,
    Order_Status text,
    Carrier_Name_And_Tracking_Number text,
    Item_Subtotal money,
    Item_Subtotal_Tax money,
    Item_Total money,
    Tax_Exemption_Applied money,
    Tax_Exemption_Type money,
    Exemption_Opt_Out money,
    Buyer_Name text,
    Currency text,
    Group_Name text
);

    ---Update Date Columns---

    COMMIT;

    ALTER TABLE purchases.items
    ALTER COLUMN Order_Date TYPE DATE
    USING to_date(Order_Date, 'MM/DD/YY');

    ALTER TABLE purchases.items
    ALTER COLUMN Release_Date TYPE DATE
    USING to_date(Release_Date, 'MM/DD/YY');

    ALTER TABLE purchases.items
    ALTER COLUMN Shipment_Date TYPE DATE
    USING to_date(Shipment_Date, 'MM/DD/YY');

    END TRANSACTION;

---Create ordersandshipments table---

CREATE TABLE purchases.ordersandshipments
(
    Order_Date varchar (256),
    Order_ID text,
    Payment_Instrument_Type text,
    Website text,
    Purchase_Order_Number text,
    Ordering_Customer_Email text,
    Shipment_Date varchar (256),
    Shipping_Address_Name text,
    Shipping_Address_Street_1 text,
    Shipping_Address_Street_2 text,
    Shipping_Address_City text,
    Shipping_Address_State text,
    Shipping_Address_Zip text,
    Order_Status text,
    Carrier_Name_And_Tracking_Number text,
    Subtotal money,
    Shipping_Charge money,
    Tax_Before_Promotions money,
    Total_Promotions money,
    Tax_Charged money,
    Total_Charged money,
    Buyer_Name text,
    Group_Name text
);

    ---Update Date Columns---

    COMMIT;

    ALTER TABLE purchases.ordersandshipments
    ALTER COLUMN Order_Date TYPE DATE
    USING to_date(Order_Date, 'MM/DD/YY');

    ALTER TABLE purchases.ordersandshipments
    ALTER COLUMN Shipment_Date TYPE DATE
    USING to_date(Shipment_Date, 'MM/DD/YY');

    END TRANSACTION;